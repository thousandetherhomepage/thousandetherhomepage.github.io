(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{356:function(e,t,r){var content=r(385);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(126).default)("03a3719c",content,!0,{sourceMap:!1})},384:function(e,t,r){"use strict";r(356)},385:function(e,t,r){var n=r(125)((function(i){return i[1]}));n.push([e.i,"label{display:block;margin-bottom:.5em}label span{display:inline-block;min-width:6em}input{width:200px}.wrapAd{border-left:10px solid #eee;padding-left:10px;width:700px}.wrapAd .previewAd img{color:rgba(0,0,0,.7);display:block;font-size:11px;overflow:hidden;white-space:nowrap}.wrapAd small{color:#966;display:inline-block;margin:.5em}.wrapAd button{background:#fff8db;border-width:2px;display:block;font-size:1em;padding:5px}.wrapAd label{line-height:2em}.wrapAd label button{display:inline-block;margin-right:.25em}.wrapAd .mini-adGrid{background:#ddd;margin-bottom:1em;padding:10px}",""]),n.locals={},e.exports=n},426:function(e,t,r){"use strict";r.r(t);var n=r(9),d=(r(62),{props:["provider","contract","ketherNFT","ad"],data:function(){return{error:null,wrapInProgress:""}},methods:{wrap:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r,n,d,o,c,l,w;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.provider.getSigner();case 2:return r=t.sent,t.next=5,r.getAddress();case 5:return n=t.sent,t.prev=6,t.next=9,e.ketherNFT.precompute(e.ad.idx,n);case 9:if(d=t.sent,d.salt,42==(o=d.predictedAddress).length&&"0x0000000000000000000000000000000000000000"!=o){t.next=14;break}throw"Invalid predictedAddress, something is wrong: "+o;case 14:if(c=e.$store.getters.precomputeEscrow({idx:e.ad.idx,KH:e.contract,KNFT:e.ketherNFT}),e.$address.equal(o,c)){t.next=17;break}throw"predictedAddress does not match expected value, something went wrong: "+o+" != "+c;case 17:return e.wrapInProgress="Fetching latest state...",t.t0=e.$address,t.next=21,e.contract.ads(e.ad.idx);case 21:if(t.t1=t.sent.owner,t.t2=o,!t.t0.equal.call(t.t0,t.t1,t.t2)){t.next=27;break}e.$store.commit("addHalfWrapped",{idx:e.ad.idx,account:n}),t.next=36;break;case 27:if(e.$store.state.halfWrapped[e.ad.idx]){t.next=36;break}return e.wrapInProgress="Check your wallet for queued transactions, there will be 2 in total.",t.next=31,e.contract.connect(r).setAdOwner(e.ad.idx,o);case 31:return l=t.sent,e.wrapInProgress="First transaction submitted, waiting... (This can take a few minutes)",t.next=35,l.wait();case 35:e.$store.commit("addHalfWrapped",{idx:e.ad.idx,account:n});case 36:return t.t3=e.$address,t.next=39,e.contract.ads(e.ad.idx);case 39:if(t.t4=t.sent.owner,t.t5=e.ketherNFT.address,t.t3.equal.call(t.t3,t.t4,t.t5)){t.next=49;break}return e.wrapInProgress="Confirm 2nd wrap transaction, check your wallet queue.",t.next=45,e.ketherNFT.connect(r).wrap(e.ad.idx,n);case 45:return w=t.sent,e.wrapInProgress="Second transaction submitted, waiting...",t.next=49,w.wait();case 49:e.$store.commit("updateAds",[{idx:e.ad.idx,update:{owner:n,wrapped:!0}}]),e.$store.commit("removeHalfWrapped",e.ad.idx),e.$emit("refresh",{idx:e.ad.idx}),e.error=null,t.next=58;break;case 55:t.prev=55,t.t6=t.catch(6),e.error=t.t6;case 58:return t.prev=58,e.wrapInProgress=!1,t.finish(58);case 61:case"end":return t.stop()}}),t,null,[[6,55,58,61]])})))()},unwrap:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r,n,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.provider.getSigner();case 2:return r=t.sent,t.next=5,r.getAddress();case 5:return n=t.sent,t.prev=6,t.t0=e.$address,t.next=10,e.contract.ads(e.ad.idx);case 10:if(t.t1=t.sent.owner,t.t2=e.ketherNFT.address,!t.t0.equal.call(t.t0,t.t1,t.t2)){t.next=19;break}return t.next=15,e.ketherNFT.connect(r).unwrap(e.ad.idx,n);case 15:return d=t.sent,e.wrapInProgress="Unwrapping transaction submitted, waiting...",t.next=19,d.wait();case 19:e.$store.commit("updateAds",[{idx:e.ad.idx,update:{wrapped:!1}}]),e.$emit("refresh",{idx:e.ad.idx}),e.error=null,t.next=27;break;case 24:t.prev=24,t.t3=t.catch(6),e.error=t.t3;case 27:return t.prev=27,e.wrapInProgress=!1,t.finish(27);case 30:case"end":return t.stop()}}),t,null,[[6,24,27,30]])})))()}}}),o=(r(384),r(60)),component=Object(o.a)(d,(function(){var e=this,t=e._self._c;return t("div",[t("form",{staticClass:"wrapAd",on:{submit:function(e){e.preventDefault()}}},[t("h3",[e._v("NFT")]),e._v(" "),e.wrapInProgress?t("p",{staticClass:"progress"},[t("img",{staticStyle:{width:"32px",height:"18px","vertical-align":"text-bottom"},attrs:{src:"/throbber.svg",alt:"‚è≥"}}),e._v(" "),t("strong",[e._v("Transaction in progress.")]),e._v(" "),t("span",[e._v(e._s(e.wrapInProgress))])]):e._e(),e._v(" "),e.ad.wrapped?t("p",[e._v("\n    Ad is wrapped to NFT.\n    "),t("button",{attrs:{type:"button",disabled:!!e.wrapInProgress},on:{click:e.unwrap}},[e._v("Unwrap #"+e._s(e.ad.idx)+" to Legacy Contract")])]):e.$store.state.halfWrapped[e.ad.idx]?t("p",[t("label",[t("button",{attrs:{type:"button",disabled:!!e.wrapInProgress},on:{click:e.wrap}},[e._v("Finish Wrapping #"+e._s(e.ad.idx)+" to NFT")]),e._v(" "),t("small",[e._v("Complete the wrapping of this ad as NFT")])])]):t("p",[t("label",[t("button",{attrs:{type:"button",disabled:!!e.wrapInProgress},on:{click:e.wrap}},[e._v("Wrap #"+e._s(e.ad.idx)+" to NFT")]),e._v(" "),t("small",[e._v("Queue up 2 on-chain transactions, roughly 31,249 + 231,727 gas = 0.0262 ETH at 100 gwei")])])])]),e._v(" "),e.error?t("p",{staticClass:"error"},[e._v("\n    "+e._s(e.error)+"\n  ")]):e._e()])}),[],!1,null,null,null);t.default=component.exports}}]);